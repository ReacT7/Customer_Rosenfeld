create or replace
TRIGGER TRG_CUSTOMER
BEFORE INSERT OR UPDATE ON CUSTOMER
FOR EACH ROW
DECLARE
BEGIN
  IF (:NEW.CREDITS < 0) THEN 
    RAISE_APPLICATION_ERROR (-20999, 'CREDITS HAVE TO BE GREATER OR EQUAL TO 0');
  END IF;
  
  IF (:NEW.BIRTHDATE > SYSDATE) THEN
    RAISE_APPLICATION_ERROR (-20998, 'BIRTHDATE MUST BE BELOW CURRENT DATE!');
  END IF;
  
  IF NOT REGEXP_LIKE(:NEW.EMAIL, '^([A-Za-z]{1})([A-Za-z\.\-0-9]*)(@)([A-Za-z]*)(\.)([A-Za-z]*)') THEN
    RAISE_APPLICATION_ERROR (-20997, 'not a valid email adress!');
  END IF;
  
  IF (UPDATING) THEN
    IF(:NEW.BIRTHDATE <> :OLD.BIRTHDATE) THEN
    RAISE_APPLICATION_ERROR (-20996, 'CANNOT CHANGE BIRTHDATE!');
    END IF;
  END IF;
END;